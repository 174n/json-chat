<!DOCTYPE html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>JSONChat</title><link rel=icon type=image/svg href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cdefs/%3E%3Cpath fill='%23333' d='M437 75A256 256 0 0027 370L1 486c-4 15 10 29 25 25l116-26A256 256 0 00437 75z'/%3E%3C/svg%3E"><script type=module>var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,r=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,o=(t,r,n)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[r]=n;!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(r){const n=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise((r,s)=>{const i=new URL(e,n);if(self[t].moduleMap[i])return r(self[t].moduleMap[i]);const a=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(a),onerror(){s(new Error("Failed to import: "+e)),o(c)},onload(){r(self[t].moduleMap[i]),o(c)}});document.head.appendChild(c)}),self[t].moduleMap={}}}("/assets/");class s{static create(...e){return new this(...e)}mixIn(e){return Object.assign(this,e)}clone(){const e=new this.constructor;return Object.assign(e,this),e}}class i extends s{constructor(e=[],t=4*e.length){super();let r=e;if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),(r instanceof Int8Array||r instanceof Uint8ClampedArray||r instanceof Int16Array||r instanceof Uint16Array||r instanceof Int32Array||r instanceof Uint32Array||r instanceof Float32Array||r instanceof Float64Array)&&(r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength)),r instanceof Uint8Array){const e=r.byteLength,t=[];for(let n=0;n<e;n+=1)t[n>>>2]|=r[n]<<24-n%4*8;this.words=t,this.sigBytes=e}else this.words=e,this.sigBytes=t}static random(e){const t=[],r=e=>{let t=e,r=987654321;const n=4294967295;return()=>{r=36969*(65535&r)+(r>>16)&n,t=18e3*(65535&t)+(t>>16)&n;let e=(r<<16)+t&n;return e/=4294967296,e+=.5,e*(Math.random()>.5?1:-1)}};for(let n,o=0;o<e;o+=4){const e=r(4294967296*(n||Math.random()));n=987654071*e(),t.push(4294967296*e()|0)}return new i(t,e)}toString(e=a){return e.stringify(this)}concat(e){const t=this.words,r=e.words,n=this.sigBytes,o=e.sigBytes;if(this.clamp(),n%4)for(let e=0;e<o;e+=1){const o=r[e>>>2]>>>24-e%4*8&255;t[n+e>>>2]|=o<<24-(n+e)%4*8}else for(let e=0;e<o;e+=4)t[n+e>>>2]=r[e>>>2];return this.sigBytes+=o,this}clamp(){const{words:e,sigBytes:t}=this;e[t>>>2]&=4294967295<<32-t%4*8,e.length=Math.ceil(t/4)}clone(){const e=super.clone.call(this);return e.words=this.words.slice(0),e}}const a={stringify(e){const{words:t,sigBytes:r}=e,n=[];for(let e=0;e<r;e+=1){const r=t[e>>>2]>>>24-e%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse(e){const t=e.length,r=[];for(let n=0;n<t;n+=2)r[n>>>3]|=parseInt(e.substr(n,2),16)<<24-n%8*4;return new i(r,t/2)}},c={stringify(e){const{words:t,sigBytes:r}=e,n=[];for(let e=0;e<r;e+=1){const r=t[e>>>2]>>>24-e%4*8&255;n.push(String.fromCharCode(r))}return n.join("")},parse(e){const t=e.length,r=[];for(let n=0;n<t;n+=1)r[n>>>2]|=(255&e.charCodeAt(n))<<24-n%4*8;return new i(r,t)}},l={stringify(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(e){throw new Error("Malformed UTF-8 data")}},parse:e=>c.parse(unescape(encodeURIComponent(e)))};class p extends s{constructor(){super(),this._minBufferSize=0}reset(){this._data=new i,this._nDataBytes=0}_append(e){let t=e;"string"==typeof t&&(t=l.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes}_process(e){let t;const{_data:r,blockSize:n}=this,o=r.words,s=r.sigBytes;let a=s/(4*n);a=e?Math.ceil(a):Math.max((0|a)-this._minBufferSize,0);const c=a*n,l=Math.min(4*c,s);if(c){for(let e=0;e<c;e+=n)this._doProcessBlock(o,e);t=o.splice(0,c),r.sigBytes-=l}return new i(t,l)}clone(){const e=super.clone.call(this);return e._data=this._data.clone(),e}}class d extends p{constructor(e){super(),this.blockSize=16,this.cfg=Object.assign(new s,e),this.reset()}static _createHelper(e){return(t,r)=>new e(r).finalize(t)}static _createHmacHelper(e){return(t,r)=>new u(e,r).finalize(t)}reset(){super.reset.call(this),this._doReset()}update(e){return this._append(e),this._process(),this}finalize(e){return e&&this._append(e),this._doFinalize()}}class u extends s{constructor(e,t){super();const r=new e;this._hasher=r;let n=t;"string"==typeof n&&(n=l.parse(n));const o=r.blockSize,s=4*o;n.sigBytes>s&&(n=r.finalize(t)),n.clamp();const i=n.clone();this._oKey=i;const a=n.clone();this._iKey=a;const c=i.words,p=a.words;for(let e=0;e<o;e+=1)c[e]^=1549556828,p[e]^=909522486;i.sigBytes=s,a.sigBytes=s,this.reset()}reset(){const e=this._hasher;e.reset(),e.update(this._iKey)}update(e){return this._hasher.update(e),this}finalize(e){const t=this._hasher,r=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(r))}}const h={stringify(e){const{words:t,sigBytes:r}=e,n=this._map;e.clamp();const o=[];for(let e=0;e<r;e+=3){const s=(t[e>>>2]>>>24-e%4*8&255)<<16|(t[e+1>>>2]>>>24-(e+1)%4*8&255)<<8|t[e+2>>>2]>>>24-(e+2)%4*8&255;for(let t=0;t<4&&e+.75*t<r;t+=1)o.push(n.charAt(s>>>6*(3-t)&63))}const s=n.charAt(64);if(s)for(;o.length%4;)o.push(s);return o.join("")},parse(e){let t=e.length;const r=this._map;let n=this._reverseMap;if(!n){this._reverseMap=[],n=this._reverseMap;for(let e=0;e<r.length;e+=1)n[r.charCodeAt(e)]=e}const o=r.charAt(64);if(o){const r=e.indexOf(o);-1!==r&&(t=r)}return((e,t,r)=>{const n=[];let o=0;for(let s=0;s<t;s+=1)if(s%4){const t=r[e.charCodeAt(s-1)]<<s%4*2|r[e.charCodeAt(s)]>>>6-s%4*2;n[o>>>2]|=t<<24-o%4*8,o+=1}return i.create(n,o)})(e,t,n)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},f=[];for(let e=0;e<64;e+=1)f[e]=4294967296*Math.abs(Math.sin(e+1))|0;const w=(e,t,r,n,o,s,i)=>{const a=e+(t&r|~t&n)+o+i;return(a<<s|a>>>32-s)+t},g=(e,t,r,n,o,s,i)=>{const a=e+(t&n|r&~n)+o+i;return(a<<s|a>>>32-s)+t},y=(e,t,r,n,o,s,i)=>{const a=e+(t^r^n)+o+i;return(a<<s|a>>>32-s)+t},m=(e,t,r,n,o,s,i)=>{const a=e+(r^(t|~n))+o+i;return(a<<s|a>>>32-s)+t};class v extends d{_doReset(){this._hash=new i([1732584193,4023233417,2562383102,271733878])}_doProcessBlock(e,t){const r=e;for(let n=0;n<16;n+=1){const o=t+n,s=e[o];r[o]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}const n=this._hash.words,o=r[t+0],s=r[t+1],i=r[t+2],a=r[t+3],c=r[t+4],l=r[t+5],p=r[t+6],d=r[t+7],u=r[t+8],h=r[t+9],v=r[t+10],_=r[t+11],O=r[t+12],b=r[t+13],A=r[t+14],E=r[t+15];let S=n[0],N=n[1],L=n[2],k=n[3];S=w(S,N,L,k,o,7,f[0]),k=w(k,S,N,L,s,12,f[1]),L=w(L,k,S,N,i,17,f[2]),N=w(N,L,k,S,a,22,f[3]),S=w(S,N,L,k,c,7,f[4]),k=w(k,S,N,L,l,12,f[5]),L=w(L,k,S,N,p,17,f[6]),N=w(N,L,k,S,d,22,f[7]),S=w(S,N,L,k,u,7,f[8]),k=w(k,S,N,L,h,12,f[9]),L=w(L,k,S,N,v,17,f[10]),N=w(N,L,k,S,_,22,f[11]),S=w(S,N,L,k,O,7,f[12]),k=w(k,S,N,L,b,12,f[13]),L=w(L,k,S,N,A,17,f[14]),N=w(N,L,k,S,E,22,f[15]),S=g(S,N,L,k,s,5,f[16]),k=g(k,S,N,L,p,9,f[17]),L=g(L,k,S,N,_,14,f[18]),N=g(N,L,k,S,o,20,f[19]),S=g(S,N,L,k,l,5,f[20]),k=g(k,S,N,L,v,9,f[21]),L=g(L,k,S,N,E,14,f[22]),N=g(N,L,k,S,c,20,f[23]),S=g(S,N,L,k,h,5,f[24]),k=g(k,S,N,L,A,9,f[25]),L=g(L,k,S,N,a,14,f[26]),N=g(N,L,k,S,u,20,f[27]),S=g(S,N,L,k,b,5,f[28]),k=g(k,S,N,L,i,9,f[29]),L=g(L,k,S,N,d,14,f[30]),N=g(N,L,k,S,O,20,f[31]),S=y(S,N,L,k,l,4,f[32]),k=y(k,S,N,L,u,11,f[33]),L=y(L,k,S,N,_,16,f[34]),N=y(N,L,k,S,A,23,f[35]),S=y(S,N,L,k,s,4,f[36]),k=y(k,S,N,L,c,11,f[37]),L=y(L,k,S,N,d,16,f[38]),N=y(N,L,k,S,v,23,f[39]),S=y(S,N,L,k,b,4,f[40]),k=y(k,S,N,L,o,11,f[41]),L=y(L,k,S,N,a,16,f[42]),N=y(N,L,k,S,p,23,f[43]),S=y(S,N,L,k,h,4,f[44]),k=y(k,S,N,L,O,11,f[45]),L=y(L,k,S,N,E,16,f[46]),N=y(N,L,k,S,i,23,f[47]),S=m(S,N,L,k,o,6,f[48]),k=m(k,S,N,L,d,10,f[49]),L=m(L,k,S,N,A,15,f[50]),N=m(N,L,k,S,l,21,f[51]),S=m(S,N,L,k,O,6,f[52]),k=m(k,S,N,L,a,10,f[53]),L=m(L,k,S,N,v,15,f[54]),N=m(N,L,k,S,s,21,f[55]),S=m(S,N,L,k,u,6,f[56]),k=m(k,S,N,L,E,10,f[57]),L=m(L,k,S,N,p,15,f[58]),N=m(N,L,k,S,b,21,f[59]),S=m(S,N,L,k,c,6,f[60]),k=m(k,S,N,L,_,10,f[61]),L=m(L,k,S,N,i,15,f[62]),N=m(N,L,k,S,h,21,f[63]),n[0]=n[0]+S|0,n[1]=n[1]+N|0,n[2]=n[2]+L|0,n[3]=n[3]+k|0}_doFinalize(){const e=this._data,t=e.words,r=8*this._nDataBytes,n=8*e.sigBytes;t[n>>>5]|=128<<24-n%32;const o=Math.floor(r/4294967296),s=r;t[15+(n+64>>>9<<4)]=16711935&(o<<8|o>>>24)|4278255360&(o<<24|o>>>8),t[14+(n+64>>>9<<4)]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),e.sigBytes=4*(t.length+1),this._process();const i=this._hash,a=i.words;for(let e=0;e<4;e+=1){const t=a[e];a[e]=16711935&(t<<8|t>>>24)|4278255360&(t<<24|t>>>8)}return i}clone(){const e=super.clone.call(this);return e._hash=this._hash.clone(),e}}d._createHelper(v),d._createHmacHelper(v);class _ extends s{constructor(e){super(),this.cfg=Object.assign(new s,{keySize:4,hasher:v,iterations:1},e)}compute(e,t){let r;const{cfg:n}=this,o=n.hasher.create(),s=i.create(),a=s.words,{keySize:c,iterations:l}=n;for(;a.length<c;){r&&o.update(r),r=o.update(e).finalize(t),o.reset();for(let e=1;e<l;e+=1)r=o.finalize(r),o.reset();s.concat(r)}return s.sigBytes=4*c,s}}const b=(e,t,r)=>_.create(r).compute(e,t);class O extends p{constructor(e,t,r){super(),this.cfg=Object.assign(new s,r),this._xformMode=e,this._key=t,this.reset()}static createEncryptor(e,t){return this.create(this._ENC_XFORM_MODE,e,t)}static createDecryptor(e,t){return this.create(this._DEC_XFORM_MODE,e,t)}static _createHelper(e){const t=e=>"string"==typeof e?D:T;return{encrypt:(r,n,o)=>t(n).encrypt(e,r,n,o),decrypt:(r,n,o)=>t(n).decrypt(e,r,n,o)}}reset(){super.reset.call(this),this._doReset()}process(e){return this._append(e),this._process()}finalize(e){return e&&this._append(e),this._doFinalize()}}O._ENC_XFORM_MODE=1,O._DEC_XFORM_MODE=2,O.keySize=4,O.ivSize=4;class A extends s{constructor(e,t){super(),this._cipher=e,this._iv=t}static createEncryptor(e,t){return this.Encryptor.create(e,t)}static createDecryptor(e,t){return this.Decryptor.create(e,t)}}function E(e,t,r){const n=e;let o;const s=this._iv;s?(o=s,this._iv=void 0):o=this._prevBlock;for(let e=0;e<r;e+=1)n[t+e]^=o[e]}class S extends A{}S.Encryptor=class extends S{processBlock(e,t){const r=this._cipher,{blockSize:n}=r;E.call(this,e,t,n),r.encryptBlock(e,t),this._prevBlock=e.slice(t,t+n)}},S.Decryptor=class extends S{processBlock(e,t){const r=this._cipher,{blockSize:n}=r,o=e.slice(t,t+n);r.decryptBlock(e,t),E.call(this,e,t,n),this._prevBlock=o}};const R={pad(e,t){const r=4*t,n=r-e.sigBytes%r,o=n<<24|n<<16|n<<8|n,s=[];for(let e=0;e<n;e+=4)s.push(o);const a=i.create(s,n);e.concat(a)},unpad(e){const t=e,r=255&t.words[t.sigBytes-1>>>2];t.sigBytes-=r}};class L extends O{constructor(e,t,r){super(e,t,Object.assign({mode:S,padding:R},r)),this.blockSize=4}reset(){let e;super.reset.call(this);const{cfg:t}=this,{iv:r,mode:n}=t;this._xformMode===this.constructor._ENC_XFORM_MODE?e=n.createEncryptor:(e=n.createDecryptor,this._minBufferSize=1),this._mode=e.call(n,this,r&&r.words),this._mode.__creator=e}_doProcessBlock(e,t){this._mode.processBlock(e,t)}_doFinalize(){let e;const{padding:t}=this.cfg;return this._xformMode===this.constructor._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e}}class k extends s{constructor(e){super(),this.mixIn(e)}toString(e){return(e||this.formatter).stringify(this)}}const P={stringify(e){let t;const{ciphertext:r,salt:n}=e;return t=n?i.create([1398893684,1701076831]).concat(n).concat(r):r,t.toString(h)},parse(e){let t;const r=h.parse(e),n=r.words;return 1398893684===n[0]&&1701076831===n[1]&&(t=i.create(n.slice(2,4)),n.splice(0,4),r.sigBytes-=16),k.create({ciphertext:r,salt:t})}};class T extends s{static encrypt(e,t,r,n){const o=Object.assign(new s,this.cfg,n),i=e.createEncryptor(r,o),a=i.finalize(t),c=i.cfg;return k.create({ciphertext:a,key:r,iv:c.iv,algorithm:e,mode:c.mode,padding:c.padding,blockSize:i.blockSize,formatter:o.format})}static decrypt(e,t,r,n){let o=t;const i=Object.assign(new s,this.cfg,n);return o=this._parse(o,i.format),e.createDecryptor(r,i).finalize(o.ciphertext)}static _parse(e,t){return"string"==typeof e?t.parse(e,this):e}}T.cfg=Object.assign(new s,{format:P});const j={execute(e,t,r,n){let o=n;o||(o=i.random(8));const s=_.create({keySize:t+r}).compute(e,o),a=i.create(s.words.slice(t),4*r);return s.sigBytes=4*t,k.create({key:s,iv:a,salt:o})}};class D extends T{static encrypt(e,t,r,n){const o=Object.assign(new s,this.cfg,n),i=o.kdf.execute(r,e.keySize,e.ivSize);o.iv=i.iv;const a=T.encrypt.call(this,e,t,i.key,o);return a.mixIn(i),a}static decrypt(e,t,r,n){let o=t;const i=Object.assign(new s,this.cfg,n);o=this._parse(o,i.format);const a=i.kdf.execute(r,e.keySize,e.ivSize,o.salt);return i.iv=a.iv,T.decrypt.call(this,e,o,a.key,i)}}D.cfg=Object.assign(T.cfg,{kdf:j});const N=[],x=[],M=[],B=[],I=[],z=[],C=[],$=[],F=[],U=[],H=[];for(let e=0;e<256;e+=1)H[e]=e<128?e<<1:e<<1^283;let q=0,J=0;for(let e=0;e<256;e+=1){let e=J^J<<1^J<<2^J<<3^J<<4;e=e>>>8^255&e^99,N[q]=e,x[e]=q;const t=H[q],r=H[t],n=H[r];let o=257*H[e]^16843008*e;M[q]=o<<24|o>>>8,B[q]=o<<16|o>>>16,I[q]=o<<8|o>>>24,z[q]=o,o=16843009*n^65537*r^257*t^16843008*q,C[e]=o<<24|o>>>8,$[e]=o<<16|o>>>16,F[e]=o<<8|o>>>24,U[e]=o,q?(q=t^H[H[H[n^t]]],J^=H[H[J]]):(J=1,q=J)}const V=[0,1,2,4,8,16,32,64,128,27,54];class K extends L{_doReset(){let e;if(this._nRounds&&this._keyPriorReset===this._key)return;this._keyPriorReset=this._key;const t=this._keyPriorReset,r=t.words,n=t.sigBytes/4;this._nRounds=n+6;const o=4*(this._nRounds+1);this._keySchedule=[];const s=this._keySchedule;for(let t=0;t<o;t+=1)t<n?s[t]=r[t]:(e=s[t-1],t%n?n>6&&t%n==4&&(e=N[e>>>24]<<24|N[e>>>16&255]<<16|N[e>>>8&255]<<8|N[255&e]):(e=e<<8|e>>>24,e=N[e>>>24]<<24|N[e>>>16&255]<<16|N[e>>>8&255]<<8|N[255&e],e^=V[t/n|0]<<24),s[t]=s[t-n]^e);this._invKeySchedule=[];const i=this._invKeySchedule;for(let t=0;t<o;t+=1){const r=o-t;e=t%4?s[r]:s[r-4],i[t]=t<4||r<=4?e:C[N[e>>>24]]^$[N[e>>>16&255]]^F[N[e>>>8&255]]^U[N[255&e]]}}encryptBlock(e,t){this._doCryptBlock(e,t,this._keySchedule,M,B,I,z,N)}decryptBlock(e,t){const r=e;let n=r[t+1];r[t+1]=r[t+3],r[t+3]=n,this._doCryptBlock(r,t,this._invKeySchedule,C,$,F,U,x),n=r[t+1],r[t+1]=r[t+3],r[t+3]=n}_doCryptBlock(e,t,r,n,o,s,i,a){const c=e,l=this._nRounds;let p=c[t]^r[0],d=c[t+1]^r[1],u=c[t+2]^r[2],h=c[t+3]^r[3],f=4;for(let e=1;e<l;e+=1){const e=n[p>>>24]^o[d>>>16&255]^s[u>>>8&255]^i[255&h]^r[f];f+=1;const t=n[d>>>24]^o[u>>>16&255]^s[h>>>8&255]^i[255&p]^r[f];f+=1;const a=n[u>>>24]^o[h>>>16&255]^s[p>>>8&255]^i[255&d]^r[f];f+=1;const c=n[h>>>24]^o[p>>>16&255]^s[d>>>8&255]^i[255&u]^r[f];f+=1,p=e,d=t,u=a,h=c}const w=(a[p>>>24]<<24|a[d>>>16&255]<<16|a[u>>>8&255]<<8|a[255&h])^r[f];f+=1;const g=(a[d>>>24]<<24|a[u>>>16&255]<<16|a[h>>>8&255]<<8|a[255&p])^r[f];f+=1;const y=(a[u>>>24]<<24|a[h>>>16&255]<<16|a[p>>>8&255]<<8|a[255&d])^r[f];f+=1;const m=(a[h>>>24]<<24|a[p>>>16&255]<<16|a[d>>>8&255]<<8|a[255&u])^r[f];f+=1,c[t]=w,c[t+1]=g,c[t+2]=y,c[t+3]=m}}K.keySize=8;const X=L._createHelper(K),{replace:Q}="",Y=/[&<>'"]/g,W={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#39;",'"':"&quot;"},G=e=>W[e],Z=String,ee=e=>{return null==e?e:(t=Z(e),Q.call(t,Y,G));
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */var t};var te,re=(te=function(e,t){return(te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}te(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),ne=Object.prototype.hasOwnProperty;function oe(e,t){return ne.call(e,t)}function se(e){if(Array.isArray(e)){for(var t=new Array(e.length),r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(e);for(var n in t=[],e)oe(e,n)&&t.push(n);return t}function ie(e){switch(typeof e){case"object":return JSON.parse(JSON.stringify(e));case"undefined":return null;default:return e}}function ae(e){for(var t,r=0,n=e.length;r<n;){if(!((t=e.charCodeAt(r))>=48&&t<=57))return!1;r++}return!0}function ce(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function le(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function pe(e){if(void 0===e)return!0;if(e)if(Array.isArray(e)){for(var t=0,r=e.length;t<r;t++)if(pe(e[t]))return!0}else if("object"==typeof e){var n=se(e),o=n.length;for(t=0;t<o;t++)if(pe(e[n[t]]))return!0}return!1}function de(e,t){var r=[e];for(var n in t){var o="object"==typeof t[n]?JSON.stringify(t[n],null,2):t[n];void 0!==o&&r.push(n+": "+o)}return r.join("\n")}var ue=function(e){function t(t,r,n,o,s){var i=this.constructor,a=e.call(this,de(t,{name:r,index:n,operation:o,tree:s}))||this;return a.name=r,a.index=n,a.operation=o,a.tree=s,Object.setPrototypeOf(a,i.prototype),a.message=de(t,{name:r,index:n,operation:o,tree:s}),a}return re(t,e),t}(Error),he=ue,fe=ie,we={add:function(e,t,r){return e[t]=this.value,{newDocument:r}},remove:function(e,t,r){var n=e[t];return delete e[t],{newDocument:r,removed:n}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:function(e,t,r){var n=ye(r,this.path);n&&(n=ie(n));var o=me(r,{op:"remove",path:this.from}).removed;return me(r,{op:"add",path:this.path,value:o}),{newDocument:r,removed:n}},copy:function(e,t,r){var n=ye(r,this.from);return me(r,{op:"add",path:this.path,value:ie(n)}),{newDocument:r}},test:function(e,t,r){return{newDocument:r,test:Oe(e[t],this.value)}},_get:function(e,t,r){return this.value=e[t],{newDocument:r}}},ge={add:function(e,t,r){return ae(t)?e.splice(t,0,this.value):e[t]=this.value,{newDocument:r,index:t}},remove:function(e,t,r){return{newDocument:r,removed:e.splice(t,1)[0]}},replace:function(e,t,r){var n=e[t];return e[t]=this.value,{newDocument:r,removed:n}},move:we.move,copy:we.copy,test:we.test,_get:we._get};function ye(e,t){if(""==t)return e;var r={op:"_get",path:t};return me(e,r),r.value}function me(e,t,r,n,o,s){if(void 0===r&&(r=!1),void 0===n&&(n=!0),void 0===o&&(o=!0),void 0===s&&(s=0),r&&("function"==typeof r?r(t,0,e,t.path):_e(t,0)),""===t.path){var i={newDocument:e};if("add"===t.op)return i.newDocument=t.value,i;if("replace"===t.op)return i.newDocument=t.value,i.removed=e,i;if("move"===t.op||"copy"===t.op)return i.newDocument=ye(e,t.from),"move"===t.op&&(i.removed=e),i;if("test"===t.op){if(i.test=Oe(e,t.value),!1===i.test)throw new he("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return i.newDocument=e,i}if("remove"===t.op)return i.removed=e,i.newDocument=null,i;if("_get"===t.op)return t.value=e,i;if(r)throw new he("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",s,t,e);return i}n||(e=ie(e));var a=(t.path||"").split("/"),c=e,l=1,p=a.length,d=void 0,u=void 0,h=void 0;for(h="function"==typeof r?r:_e;;){if(u=a[l],o&&"__proto__"==u)throw new TypeError("JSON-Patch: modifying `__proto__` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(r&&void 0===d&&(void 0===c[u]?d=a.slice(0,l).join("/"):l==p-1&&(d=t.path),void 0!==d&&h(t,0,e,d)),l++,Array.isArray(c)){if("-"===u)u=c.length;else{if(r&&!ae(u))throw new he("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",s,t,e);ae(u)&&(u=~~u)}if(l>=p){if(r&&"add"===t.op&&u>c.length)throw new he("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",s,t,e);if(!1===(i=ge[t.op].call(t,c,u,e)).test)throw new he("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return i}}else if(u&&-1!=u.indexOf("~")&&(u=le(u)),l>=p){if(!1===(i=we[t.op].call(t,c,u,e)).test)throw new he("Test operation failed","TEST_OPERATION_FAILED",s,t,e);return i}c=c[u]}}function ve(e,t,r,n,o){if(void 0===n&&(n=!0),void 0===o&&(o=!0),r&&!Array.isArray(t))throw new he("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");n||(e=ie(e));for(var s=new Array(t.length),i=0,a=t.length;i<a;i++)s[i]=me(e,t[i],r,!0,o,i),e=s[i].newDocument;return s.newDocument=e,s}function _e(e,t,r,n){if("object"!=typeof e||null===e||Array.isArray(e))throw new he("Operation is not an object","OPERATION_NOT_AN_OBJECT",t,e,r);if(!we[e.op])throw new he("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",t,e,r);if("string"!=typeof e.path)throw new he("Operation `path` property is not a string","OPERATION_PATH_INVALID",t,e,r);if(0!==e.path.indexOf("/")&&e.path.length>0)throw new he('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",t,e,r);if(("move"===e.op||"copy"===e.op)&&"string"!=typeof e.from)throw new he("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&void 0===e.value)throw new he("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",t,e,r);if(("add"===e.op||"replace"===e.op||"test"===e.op)&&pe(e.value))throw new he("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",t,e,r);if(r)if("add"==e.op){var o=e.path.split("/").length,s=n.split("/").length;if(o!==s+1&&o!==s)throw new he("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",t,e,r)}else if("replace"===e.op||"remove"===e.op||"_get"===e.op){if(e.path!==n)throw new he("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",t,e,r)}else if("move"===e.op||"copy"===e.op){var i=be([{op:"_get",path:e.from,value:void 0}],r);if(i&&"OPERATION_PATH_UNRESOLVABLE"===i.name)throw new he("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",t,e,r)}}function be(e,t,r){try{if(!Array.isArray(e))throw new he("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(t)ve(ie(t),ie(e),r||!0);else{r=r||_e;for(var n=0;n<e.length;n++)r(e[n],n,t,void 0)}}catch(e){if(e instanceof he)return e;throw e}}function Oe(e,t){if(e===t)return!0;if(e&&t&&"object"==typeof e&&"object"==typeof t){var r,n,o,s=Array.isArray(e),i=Array.isArray(t);if(s&&i){if((n=e.length)!=t.length)return!1;for(r=n;0!=r--;)if(!Oe(e[r],t[r]))return!1;return!0}if(s!=i)return!1;var a=Object.keys(e);if((n=a.length)!==Object.keys(t).length)return!1;for(r=n;0!=r--;)if(!t.hasOwnProperty(a[r]))return!1;for(r=n;0!=r--;)if(!Oe(e[o=a[r]],t[o]))return!1;return!0}return e!=e&&t!=t}var Ae=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",JsonPatchError:he,deepClone:fe,getValueByPointer:ye,applyOperation:me,applyPatch:ve,applyReducer:function(e,t,r){var n=me(e,t);if(!1===n.test)throw new he("Test operation failed","TEST_OPERATION_FAILED",r,t,e);return n.newDocument},validator:_e,validate:be,_areEquals:Oe}),Ee=new WeakMap,Se=function(e){this.observers=new Map,this.obj=e},Re=function(e,t){this.callback=e,this.observer=t
/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017 Joachim Wester
 * MIT license
 */};function Le(e,t){var r,n=function(e){return Ee.get(e)}(e);if(n){var o=function(e,t){return e.observers.get(t)}(n,t);r=o&&o.observer}else n=new Se(e),Ee.set(e,n);if(r)return r;if(r={},n.value=ie(e),t){r.callback=t,r.next=null;var s=function(){ke(r)},i=function(){clearTimeout(r.next),r.next=setTimeout(s)};"undefined"!=typeof window&&(window.addEventListener("mouseup",i),window.addEventListener("keyup",i),window.addEventListener("mousedown",i),window.addEventListener("keydown",i),window.addEventListener("change",i))}return r.patches=[],r.object=e,r.unobserve=function(){ke(r),clearTimeout(r.next),function(e,t){e.observers.delete(t.callback)}(n,r),"undefined"!=typeof window&&(window.removeEventListener("mouseup",i),window.removeEventListener("keyup",i),window.removeEventListener("mousedown",i),window.removeEventListener("keydown",i),window.removeEventListener("change",i))},n.observers.set(t,new Re(t,r)),r}function ke(e,t){void 0===t&&(t=!1);var r=Ee.get(e.object);Pe(r.value,e.object,e.patches,"",t),e.patches.length&&ve(r.value,e.patches);var n=e.patches;return n.length>0&&(e.patches=[],e.callback&&e.callback(n)),n}function Pe(e,t,r,n,o){if(t!==e){"function"==typeof t.toJSON&&(t=t.toJSON());for(var s=se(t),i=se(e),a=!1,c=i.length-1;c>=0;c--){var l=e[d=i[c]];if(!oe(t,d)||void 0===t[d]&&void 0!==l&&!1===Array.isArray(t))Array.isArray(e)===Array.isArray(t)?(o&&r.push({op:"test",path:n+"/"+ce(d),value:ie(l)}),r.push({op:"remove",path:n+"/"+ce(d)}),a=!0):(o&&r.push({op:"test",path:n,value:e}),r.push({op:"replace",path:n,value:t}));else{var p=t[d];"object"==typeof l&&null!=l&&"object"==typeof p&&null!=p?Pe(l,p,r,n+"/"+ce(d),o):l!==p&&(o&&r.push({op:"test",path:n+"/"+ce(d),value:ie(l)}),r.push({op:"replace",path:n+"/"+ce(d),value:ie(p)}))}}if(a||s.length!=i.length)for(c=0;c<s.length;c++){var d;oe(e,d=s[c])||void 0===t[d]||r.push({op:"add",path:n+"/"+ce(d),value:ie(t[d])})}}}var Te=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",unobserve:function(e,t){t.unobserve()},observe:Le,generate:ke,compare:function(e,t,r){void 0===r&&(r=!1);var n=[];return Pe(e,t,n,"",r),n}});Object.assign({},Ae,Te,{JsonPatchError:ue,deepClone:ie,escapePathComponent:ce,unescapePathComponent:le});const je="d4145a 8e78ff ff7300 fbb03b ed1e79 019244 ed1c23 2e3192 fc7d7b fecc00 3aa17e 4f00bc 09c9be 662d8c 00a8c5 1353ae".split(" ");function De(e){const t=e.split("").map(e=>e.charCodeAt(0)).reduce((e,t)=>16777619*((e^t)>>>0),2166136261);return`<svg viewBox="-1.5 -1.5 8 8" xmlns="http://www.w3.org/2000/svg" fill="#${je[t/16777619%je.length]||""}">${e?[...Array(25).keys()].map(e=>t%(16-e%15)<4?`<rect x="${e>14?7-~~(e/5):~~(e/5)}" y="${e%5}" width="1" height="1"/>`:"").join(""):[]}</svg>`}window.year=(new Date).getFullYear(),document.body.setAttribute("style","");const Ne=document.querySelector("#overlay"),xe=document.querySelector("#chat-name"),Me=document.querySelector("#chat-password"),Be=document.querySelector("#chat-server"),Ie=document.querySelector("#msgs"),ze=document.querySelector("#msg-input"),Ce=document.querySelector("#password-form"),$e=document.querySelector("#msg-form"),Fe=document.querySelector("#loading-bar"),Ue=document.querySelector("#typing"),He=document.querySelector("#upload-btn"),qe=document.querySelector("#image-popup");window.throwErrorAndReload=e=>{window.errorAccured||(window.errorAccured=!0,window.leaving||alert(e),location.reload())},window.onbeforeunload=()=>{window.leaving=!0},(async()=>{window.timeDiff=0;try{const e=Date.now(),t=1e3*(await(await fetch("https://use.ntpjs.org/v1/time.json")).json()).now;window.timeDiff=parseInt((Date.now()+e-2*t)/2)}catch(e){}})(),Be.value=Be.value.replace("%servername%","file:"===location.protocol||location.host.match(/^localhost:\d{2,4}$/g)?"http://localhost:3000":location.origin+"/json"),window.uploadFile=()=>{let e;return new Promise((s,i)=>{const a=document.createElement("input");a.setAttribute("type","file"),a.click();const c=async a=>{try{const i=(await X.encrypt(JSON.stringify(((e,s)=>{for(var i in s||(s={}))t.call(s,i)&&o(e,i,s[i]);if(r)for(var i of r(s))n.call(s,i)&&o(e,i,s[i]);return e})({url:a.target.result},e)),window.chatPass)).toString(),c=b(a.target.result).toString(),l=`${Be.value.replace(/^(lp|l|p):(\s|)+/g,"").split("/").slice(0,-1).join("/")}/${b(window.chatPass+c).toString()}`;await(await fetch(l,{method:"PUT",headers:{"content-type":"application/json"},body:JSON.stringify({file:i})})),s(l)}catch(e){i(e)}};a.addEventListener("change",()=>{const t=a.files[0];if(t.size>1e5)return void alert("Файл не больше 100кб");e={name:t.name,modified:t.lastModified,size:t.size};const r=new FileReader;r.addEventListener("load",c),r.readAsDataURL(t)})})},He.addEventListener("click",async()=>{let e;try{e=await uploadFile()}catch(e){return}e&&(ze.value=`$[](${e})`,Ze())}),window.browserFingerprint=(e=>{let t,r,n=0;if(0===e.length)return n;for(t=0;t<e.length;t++)r=e.charCodeAt(t),n=(n<<5)-n+r,n|=0;return n.toString(32)})([navigator.userAgent,[screen.height,screen.width,screen.colorDepth].join("x"),(new Date).getTimezoneOffset(),!!window.sessionStorage,!!window.localStorage,Object.keys(navigator.plugins).map(e=>[navigator.plugins[e].name,navigator.plugins[e].description,Object.keys(navigator.plugins[e]).map(t=>[navigator.plugins[e][t].type,navigator.plugins[e][t].suffixes].join("~")).join(",")].join("::")).join(";")].join("###")).toString();const Je=(e,t="")=>`<a onclick="imagePopup(this)" class="image"><img src="${e}" alt="${t}"></a>`,Ve=(e,t,r,n)=>{qe.style.top=e+"px",qe.style.left=t+"px",qe.style.width=r+"px",qe.style.height=n+"px"};window.imagePopup=e=>{const t=(null==e?void 0:e.children)?e.children[0]:null,r=null==t?void 0:t.getBoundingClientRect();r?(qe.classList.add("hidden"),window.popupOrigin=[r.top,r.left,r.width,r.height],Ve(...popupOrigin),qe.style.backgroundImage=`url(${t.src})`,setTimeout(()=>{Ve(0,0,window.innerWidth,window.innerHeight),qe.classList.remove("hidden")},300)):t&&window.open(t.src,"_blank")},window.closePopup=()=>{Ve(...popupOrigin),setTimeout(()=>{qe.classList.add("hidden"),qe.setAttribute("style","")},300)},qe.addEventListener("click",closePopup),window.addEventListener("keyup",e=>{"Escape"===e.key&&closePopup()}),window.urlRegex="(https?:\\/\\/(www.)?[-a-zа-я0-9@:%._\\+~#=]{1,256}\\.[a-zа-я0-9()]{1,6}\\b([-a-zа-я0-9()@:%_\\+.,;~#?&//=]*))",window.encfilesCache={};const Ke=(e=0)=>[...document.querySelectorAll("[data-date]")].slice(e).forEach(e=>e.innerText=(e=>{let t,r,n=0|(Date.now()-e)/1e3,o={"сек":60,"мин":60,"ч":24};for(t in o)if(r=n%o[t],!(n=0|n/o[t]))return r+" "+t+". назад";return new Date(e).toLocaleString("ru").replace(new RegExp("\\."+year),"").slice(0,-3)})(parseInt(e.getAttribute("data-date"))));setInterval(()=>Ke(-3),1e3),setInterval(()=>Ke(-15),6e4),window.navestiSuetu=()=>setInterval(()=>{document.querySelector(".icon-bg").innerHTML=Array.from({length:(window.innerHeight+window.innerWidth)/10}).map(()=>De(Math.random().toString())).join("\n")},500);const Xe=async(e,t)=>{const{name:r,date:n,msg:o,fingerprint:s}=await(async e=>{const t=(await X.decrypt(e.data,window.chatPass)).toString(l);try{return JSON.parse(t)}catch(e){return console.error(e),{}}})(e);if(!(r&&n&&o&&s))return void throwErrorAndReload("Message parsing error");const i=document.createElement("div"),a=document.createElement("div"),c=document.createElement("div");var p;i.classList.add("message"),c.classList.add("avatar"),a.classList.add("msg"),c.onclick=async e=>{messages.splice(t+2,1)},c.innerHTML=""+De(s),s===browserFingerprint&&a.classList.add("mine"),e.notSent&&a.classList.add("not-sent"),r===chatName&&i.classList.add("same-name"),a.innerHTML=`\n    <div class="title-line">\n      <div class="name">${ee(r)}</div>\n      <div class="fingerprint">[${s.slice(0,10)}]</div>\n    </div>\n    <div class="text">${p=ee(o),p.replace(/(_[^*_]+)\*([^*_]+_)/g,"$1_*_$2").replace(/\*([^*]+)\*/g,"<b>$1</b>").replace(/_([^_]+)_/g,"<em>$1</em>").replace(new RegExp("(?<!\\]\\()"+urlRegex,"gi"),'<a href="$1" target="_blank">$1</a>').replace(new RegExp(`!\\[([^\\]]{0,255})\\]\\(${urlRegex}\\)`,"gi"),Je("$2","$1")).replace(new RegExp(`\\$\\[([^\\]]{0,255})\\]\\(${urlRegex}\\)`,"gi"),(...e)=>encfilesCache[e[2]]?Je(encfilesCache[e[2]].url,encfilesCache[e[1]]):`<span data-encfile="${e[2]}" class="encfile"></span>`).replace(/\n/g,"<br />")}</div>\n    <div class="date" data-date="${n+timeDiff}"></div>\n  `,i.append(c),i.append(a),Ie.append(i)};window.createChat=async e=>await(await fetch(`${Be.value.replace(/^(lp|l|p):(\s|)+/g,"").split("/").slice(0,-1).join("/")}/${b(e||Me.value,Be.value.split("/").slice(-1).join("/")).toString()}`,{method:"PUT",headers:{"content-type":"application/json"},body:"[]"})),window.onresize=()=>{Ye()},ze.addEventListener("input",((e,t)=>{let r=0;return(...e)=>{let t=(new Date).getTime();if(!(t-r<5e3))return r=t,(async()=>{if(chatLongpollSupported&&chatPatchSupported){const e=messages.filter(e=>e&&e.typing);if(e&&e[0]){const t=JSON.parse(await X.decrypt(e[0].typing,window.chatPass).toString(l)),r=[...(null==t?void 0:t.filter(e=>Date.now()-e.timestamp+timeDiff<3e4))||[],{chatName:chatName,timestamp:Date.now()-timeDiff,browserFingerprint:browserFingerprint}];e[0].typing=await X.encrypt(JSON.stringify(r),chatPass).toString()}else messages.push({typing:await X.encrypt(JSON.stringify([{chatName:chatName,timestamp:Date.now()-timeDiff,browserFingerprint:browserFingerprint}]),chatPass).toString()})}})(...e)}})());const Qe=async()=>{var e,t,r;let n=messages.filter(e=>e&&e.typing);if(!n[0]||!n[0].typing)return;const o=null==(r=null==(t=null==(e=JSON.parse(await X.decrypt(n[0].typing,window.chatPass).toString(l)))?void 0:e.filter(e=>Date.now()-e.timestamp+timeDiff<2e4&&e.chatName!==chatName&&e.browserFingerprint!==browserFingerprint))?void 0:t.map(e=>e.chatName))?void 0:r.filter((e,t,r)=>r.indexOf(e)===t);o&&o.length>0?Ue.innerText=`${o.join()} набира${o.length>1?"ют":"ет"} сообщение...`:Ue.innerText=""};window.observeMessages=()=>{window.messagesObserver=Le(window.messages,async e=>{await(async e=>{try{const t=await(await fetch(window.chatAddr+(chatPatchSupported?"?patch=true":""),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(chatPatchSupported?e:messages)})).json();t.error&&throwErrorAndReload(t.error)}catch(e){return throwErrorAndReload(e)}[...document.querySelectorAll(".not-sent")].forEach(e=>e.classList.remove("not-sent")),Ye(),We()})(e)})},window.setLongpollMessages=e=>{messagesObserver.unobserve(),Ie.classList.add("loading"),window.messages=e,(e||e.length>0)&&(Ie.innerHTML="",e.filter(e=>e&&e.data).forEach(Xe),Ye(),We()),Ie.classList.remove("loading"),Ke(),observeMessages()};const Ye=()=>{setTimeout(()=>{Ie.scrollTop=Ie.scrollHeight,Ke()},300)},We=async()=>{await Promise.all(Array.from(document.images).filter(e=>!e.complete).map(e=>new Promise(t=>{e.onload=e.onerror=t}))),Ye()},Ge=async e=>{if(chatLongpollSupported&&chatPatchSupported&&!e&&setInterval(Qe,5e3),chatLongpollSupported&&!e)try{const e=await fetch(window.chatAddr+"?longpoll=true");200===e.status?setLongpollMessages(await e.json()):204!==e.status&&throwErrorAndReload("Error loading messages with longpoll"),Ge()}catch(e){throwErrorAndReload(e)}else Fe.classList.toggle("toggle"),Fe.classList.toggle("toggle"),Fe.classList.toggle("full"),Ie.classList.add("loading"),setTimeout(async()=>{Ie.innerHTML="";try{window.messages=await(await fetch(window.chatAddr)).json()}catch(e){throwErrorAndReload(e)}messages&&messages instanceof Array||throwErrorAndReload("Messages not loaded"),messages.filter(e=>e&&e.data).forEach(Xe),Ie.classList.remove("loading"),We(),Ye(),e&&observeMessages()},300),chatLongpollSupported||setTimeout(Ge,15e3);chatLongpollSupported&&e&&(Fe.remove(),Ge()),setTimeout(()=>{[...document.querySelectorAll("[data-encfile]")].forEach(async e=>{const t=e.getAttribute("data-encfile");let r;try{r=await(await fetch(t)).json()}catch(t){return void(e.outerHTML=`<b class="error">${t}</b>`)}if(r&&r.file){const n=encfilesCache[t]||JSON.parse(await X.decrypt(r.file,window.chatPass).toString(l));n.url.match(/^data:image/g)?(e.outerHTML=Je(n.url),encfilesCache[t]=n):e.outerHTML='<b class="error">тип файла пока не поддерживается</b>',Ye()}})},1e3)};Ce.addEventListener("submit",e=>{e.preventDefault(),window.chatPass=Me.value,window.chatName=xe.value,window.chatLongpollSupported=!!Be.value.match(/^(p|)l(p|):/g),window.chatPatchSupported=!!Be.value.match(/^(l|)p(l|):/g),Be.value=Be.value.replace(/^(lp|l|p):(\s|)+/g,""),window.chatAddr=`${Be.value.split("/").slice(0,-1).join("/")}/${b(Me.value,Be.value.split("/").slice(-1).join("/")).toString()}`,Ne.classList.add("hidden"),Me.value="",xe.value="",Ge(!0)}),window.notify=()=>{window.messages.filter(e=>e&&e.webhook).forEach(async e=>{const t=await X.decrypt(e.webhook,window.chatPass).toString(l);t.match(new RegExp(urlRegex,"gi"))&&await fetch(t)})},$e.addEventListener("submit",async e=>{e.preventDefault(),Ze()});const Ze=async()=>{if(window.chatAddr){if("navestiSuetu"===ze.value)return navestiSuetu(),void(ze.value="");const e={data:await X.encrypt(JSON.stringify({name:chatName,fingerprint:browserFingerprint,date:Date.now()-timeDiff,msg:ze.value}),chatPass).toString()};messages.push(e),await Xe({data:e.data,notSent:!0},messages.length-1),Ye(),We(),ze.value="",notify()}}</script><style type=text/css>*{box-sizing:border-box;transition:all .3s ease-in-out}body,html{height:100%}body{background-color:#111;color:#fff;margin:0;padding:0;max-height:100%}body,button,input,textarea{font-family:Montserrat,sans-serif}a{color:#8da89e;text-decoration:none;position:relative;word-wrap:break-word}a:hover{text-decoration:underline}input{flex-grow:1;padding:10px 15px;border-radius:15px;outline:0;border:0;background-color:#333;margin-bottom:5px;color:#fff}input:focus{background-color:#394440}button{outline:0;border:0;background-color:#333;color:#fff;cursor:pointer;padding:10px 15px;margin-bottom:5px;border-radius:15px}.write button:focus,button:hover{background-color:#394440}.container{width:100%;max-width:720px;margin:0 auto;background-color:#222;padding-bottom:5px;height:100%;max-height:100%}.reload-status{position:fixed;bottom:0;width:100%;max-width:720px;left:50%;transform:translateX(-50%);height:5px;background-color:#333}.reload-status .bar{background-color:#394440;height:100%;width:0%;transition-duration:15s;transition-property:width;transition-timing-function:linear}.reload-status .bar.toggle{display:none}.reload-status .bar.full{width:100%}.chat{height:100%;display:flex;justify-content:space-between;flex-direction:column}.msgs{flex-direction:column;padding:10px;display:flex;align-items:flex-start;overflow-y:auto;scrollbar-width:thin}.msgs::-webkit-scrollbar{width:12px}.msgs::-webkit-scrollbar-track{background:#333}.msgs::-webkit-scrollbar-thumb{background-color:#394440;border-radius:20px;border:3px solid #333}.msgs.loading{filter:blur(5px)}.msgs .message{display:flex;align-items:center;max-width:80%}.msgs .avatar{height:45px;width:45px;background-color:#333;border-radius:50%;overflow:hidden;display:flex;align-items:flex-end;justify-content:center;position:relative}.msgs .avatar:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;transition:all .3s ease-in-out;background-color:rgba(0,0,0,.8);background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 47.971 47.971' fill='%23fff'%3E%3Cdefs/%3E%3Cpath d='M28.228 23.986L47.092 5.122a2.998 2.998 0 000-4.242 2.998 2.998 0 00-4.242 0L23.986 19.744 5.121.88a2.998 2.998 0 00-4.242 0 2.998 2.998 0 000 4.242l18.865 18.864L.879 42.85a2.998 2.998 0 104.242 4.241l18.865-18.864L42.85 47.091c.586.586 1.354.879 2.121.879s1.535-.293 2.121-.879a2.998 2.998 0 000-4.242L28.228 23.986z'/%3E%3C/svg%3E");background-size:40%;background-position:center;background-repeat:no-repeat;cursor:pointer}.msgs .avatar:hover:after{opacity:1;backdrop-filter:blur(2px)}.msgs .avatar img{height:90%;width:90%}.msgs .message.same-name{align-self:flex-end}.msg{background-color:#333;padding:10px 15px;margin:10px;min-width:200px;max-width:100%;border-radius:15px;position:relative;padding-bottom:25px;overflow:hidden;max-width:calc(100% - 70px);position:relative;z-index:99;word-break:break-word}.msgs .avatar:hover+.msg{filter:blur(2px) brightness(.5)}.msg.mine{background-color:#394440}.encfile{width:100%;height:5px}.error{color:#ff5b5b}.encfile:after,.msg.not-sent:after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 1084 322'%3E%3Cdefs/%3E%3Cdefs%3E%3Cpattern id='b' width='76.8' height='76.8' patternUnits='userSpaceOnUse'%3E%3Cg transform='scale(.3)'%3E%3Cdefs%3E%3Cg id='a' fill='%23fff'%3E%3Cpath d='M256-128h128l-512 512V256zM384 0v128L128 384H0z'/%3E%3C/g%3E%3C/defs%3E%3Cg%3E%3Cuse x='-256' xlink:href='%23a'/%3E%3Cuse xlink:href='%23a'/%3E%3CanimateTransform attributeName='transform' dur='0.5s' keyTimes='0;1' repeatCount='indefinite' type='translate' values='0 0; 256 0'/%3E%3C/g%3E%3C/g%3E%3C/pattern%3E%3C/defs%3E%3Cpath fill='url(%23b)' d='M0 0h1084v322H0z'/%3E%3C/svg%3E");background-size:cover;opacity:.1}.msg .title-line{display:flex;justify-content:space-between;font-size:.8em;margin-bottom:5px;color:#ccc}.msg .date,.msg .fingerprint{font-size:.7em}.msg .fingerprint{letter-spacing:.1em;opacity:.5}.msg .date{position:absolute;bottom:5px;color:#aaa;right:15px}.msg .text{line-height:1.3em;letter-spacing:.01em}.msg .text img{max-width:100%;max-height:300px;padding:5px 0}#typing{position:absolute;font-size:.8em;margin-top:-20px;color:#666;margin-left:5px}.write{padding:10px;display:flex}.write button{margin-left:10px;border-radius:100%;width:40px;height:40px;display:flex;align-items:center;justify-content:center;padding:0}.write button svg{width:30px;height:30px}.overlay{position:fixed;z-index:9999;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.6);backdrop-filter:blur(3px);display:flex;align-items:center;justify-content:center}.overlay:before,body:before{pointer-events:none;content:'';position:absolute;top:0;left:0;width:100%;height:100%;background-size:10%;z-index:9;opacity:.1;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 300'%3E%3Cdefs/%3E%3Cfilter id='a' x='0' y='0'%3E%3CfeTurbulence baseFrequency='.8' stitchTiles='stitch' type='fractalNoise'/%3E%3C/filter%3E%3Crect width='300' height='300' fill='%23000'/%3E%3Crect width='300' height='300' filter='url(%23a)' /%3E%3C/svg%3E")}.overlay.hidden{opacity:0;visibility:hidden;z-index:-1}.password{display:flex;flex-direction:column}.password button{min-width:250px;max-width:100%}.fullwidth{width:100%}a.image{cursor:pointer}#image-popup{top:0;left:0;z-index:99999;position:absolute;width:5px;height:5px;background-size:contain;background-repeat:no-repeat;background-position:center}#image-popup.hidden{visibility:hidden;pointer-events:none;opacity:0}.icon-bg{position:absolute;width:100%;height:100%;top:0;left:0;z-index:-1;overflow:hidden;display:flex;justify-content:space-around;flex-wrap:wrap;opacity:.05}.icon-bg svg{width:100px;height:100px;transform:rotate(10deg);animation:rotation .5s}@keyframes rotation{from{transform:rotate(0)}to{transform:rotate(359deg)}}</style></head><body style=display:none><div class=icon-bg></div><div class=overlay id=overlay><form class=password autocomplete=off id=password-form><input type=text autocomplete=off required id=chat-server placeholder=Сервер value=lp:%servername%/x4z35solRfSNx8s/usdihNpc7z4PfXFYNHWUjZaTAW> <input type=text autocomplete=off required id=chat-name placeholder=Имя> <input type=password autocomplete=off required id=chat-password placeholder=Пароль> <button type=submit class=fullwidth>Войти</button></form></div><div class=container><div class=chat><div class=msgs id=msgs></div><form class=write autocomplete=off id=msg-form><div id=typing></div><input type=text required id=msg-input placeholder=Сообщение...> <button type=submit><svg xmlns=http://www.w3.org/2000/svg fill=none viewBox="0 0 24 24"><defs/><path fill=#ccc d="M7.8 6.1l-2.3-.8c-.6-.1-1.3-.2-1.9.3-.5.6-.4 1.3-.3 1.9l1 2.2.6 1.6H10a.8.8 0 010 1.4H4.9l-.7 1.6-.9 2.2c-.1.6-.2 1.3.3 1.9.6.5 1.3.4 1.9.3l2.3-.8L19.2 13l.6-.2c.1-.1.5-.4.5-.9s-.4-.8-.5-.9a5 5 0 00-.6-.2L7.8 6z"/></svg></button> <button type=reset id=upload-btn><svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 30 30"><defs/><path fill=#ccc d="M7 2a2 2 0 00-2 2v22c0 1.1.9 2 2 2h8.5A9 9 0 0125 14.2V9.5a1 1 0 00-.3-.7l-6.5-6.5a1 1 0 00-.7-.3H7zm10 1.9l6.1 6.1H18a1 1 0 01-1-1V3.9zM23 16a7 7 0 100 14 7 7 0 000-14zm0 3c.6 0 1 .4 1 1v2h2a1 1 0 110 2h-2v2a1 1 0 11-2 0v-2h-2a1 1 0 110-2h2v-2c0-.6.4-1 1-1z"/></svg></button></form></div></div><div class=reload-status><div class="bar full" id=loading-bar></div></div><div id=image-popup class=hidden></div></body></html>